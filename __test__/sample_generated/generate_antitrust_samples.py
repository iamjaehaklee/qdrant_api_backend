#!/usr/bin/env python3
"""
Generate 60 JSON test files for antitrust cartel investigation case.
Target: ocr_summaries collection schema for Qdrant DB
"""

import json
import uuid
from datetime import datetime, timedelta
from pathlib import Path

# Configuration
OUTPUT_DIR = Path(__file__).parent / "공정거래법_위반조사" / "ocr_summaries"
PROJECT_ID = 3001  # Consistent project ID for this case
BASE_DATE = datetime(2024, 1, 15)

# Generate realistic data
COMPANIES = ["(주)태평양건설", "(주)한국종합건설", "(주)대한건설산업", "(주)서울엔지니어링"]
COMPANY_CONTACTS = {
    "(주)태평양건설": ["박영수 부장", "김철수 과장"],
    "(주)한국종합건설": ["이민호 이사", "정수진 차장"],
    "(주)대한건설산업": ["최진우 본부장", "강미영 팀장"],
    "(주)서울엔지니어링": ["윤동현 상무", "한지혜 부장"]
}

BID_PROJECTS = [
    "서울시_지하철_9호선_연장공사",
    "인천공항_제2여객터미널_건설",
    "부산항_신항_개발사업",
    "경기도_광역상수도_확장공사"
]

def generate_timestamp(days_offset=0, hours_offset=0):
    """Generate ISO timestamp with offset from base date"""
    dt = BASE_DATE + timedelta(days=days_offset, hours=hours_offset)
    return dt.strftime("%Y-%m-%dT%H:%M:%S+00:00")

def create_json_file(filename, file_id, summary_text, days_offset=0):
    """Create a single JSON file"""
    data = {
        "summary_id": str(uuid.uuid4()),
        "project_id": PROJECT_ID,
        "file_id": file_id,
        "summary_text": summary_text,
        "created_at": generate_timestamp(days_offset)
    }

    filepath = OUTPUT_DIR / f"{filename}.json"
    with open(filepath, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    return filepath

def generate_all_files():
    """Generate all 60 JSON files"""
    OUTPUT_DIR.mkdir(parents=True, exist_ok=True)

    file_id = 1
    generated_files = []

    # 1. 심사보고서 및 처분서류 (10 files)
    investigation_docs = [
        ("심사착수보고서", "공정거래위원회 심사착수보고서 (사건번호 2024심제1001). 2024년 1월 착수. 서울시 지하철 9호선 연장공사, 인천공항 제2여객터미널 건설 등 주요 국책사업 입찰과정에서 4개 건설사 간 담합 혐의 포착. (주)태평양건설, (주)한국종합건설, (주)대한건설산업, (주)서울엔지니어링을 조사 대상으로 지정. 현장조사 및 자료제출명령 예정."),
        ("심사진행보고서_1차", f"제1차 심사진행상황 보고서 (사건번호 2024심제1001). {COMPANIES[0]} 및 {COMPANIES[1]}에 대한 조사 진행 중. 2024년 4월까지 확보한 증거: 담당자 간 통화내역 47건, 비공식 회의록 12건. 두 회사 담당자 간 입찰 전 빈번한 연락이 확인되며, 가격 협의 정황 포착. 추가 조사 필요."),
        ("심사진행보고서_2차", f"제2차 심사진행상황 보고서 (사건번호 2024심제1001). {COMPANIES[2]} 및 {COMPANIES[3]}에 대한 조사 완료. 확보 증거: 이메일 89건, 계약서 23건. {COMPANIES[2]} 영업본부장 명의 내부 이메일에서 '협의된 가격 준수' 지시 내용 발견. 4개사 간 체계적 담합 구조 확인됨."),
        ("공정거래위원회_심사보고서", f"공정거래위원회 최종 심사보고서 (사건번호 2024심제1001). {COMPANIES[0]}, {COMPANIES[1]}, {COMPANIES[2]}, {COMPANIES[3]} 4개사가 2023년 10월부터 2024년 3월까지 총 23건의 건설공사 입찰에서 부당한 공동행위(담합)를 한 사실이 명백히 인정됨. 총 계약금액 4,850억원 규모. 비공식 회의를 통한 물량배분, 순번제 운영, 입찰가격 사전 조율 등 체계적 담합 구조 확인. 공정거래법 제40조 제1항 제1호 위반. 시정명령 및 과징금 부과 권고."),
        ("전원회의_의결서", "공정거래위원회 전원회의 의결서 (사건번호 2024심제1001, 2024년 9월 15일). 심사보고서 내용을 심의한 결과, 4개 건설사의 입찰담합 행위가 공정거래법 위반에 해당한다고 판단함. 표결 결과 찬성 8명, 반대 1명으로 위반행위 인정. 시정명령 및 과징금 총 487억원 부과를 의결함. 검찰 고발 및 언론공표도 함께 결정."),
        ("시정명령서", f"시정명령서 (사건번호 2024심제1001, 2024년 9월 20일 발령). 수령인: {COMPANIES[0]}, {COMPANIES[1]}, {COMPANIES[2]}, {COMPANIES[3]}. 명령 내용: (1) 입찰담합 행위를 즉시 중지할 것. (2) 재발방지를 위한 구체적 대책을 수립하고 이행할 것. (3) 공정거래 자율준수 프로그램(CP)을 도입하여 운영할 것. (4) 임직원에 대한 공정거래법 교육을 분기별로 실시할 것. 본 명령을 이행하지 않을 경우 이행강제금이 부과될 수 있음."),
        ("과징금_부과결정서", f"과징금 부과결정서 (사건번호 2024심제1001). 총 과징금 487억원 부과. 세부 내역: {COMPANIES[0]} 145억원, {COMPANIES[1]} 132억원, {COMPANIES[2]} 118억원, {COMPANIES[3]} 92억원. 산정 근거: 위반행위 관련 매출액의 10% (공정거래법 시행령 제61조). 납부기한 2024년 12월 20일까지. 기한 내 미납 시 국세체납처분의 예에 따라 강제징수함."),
        ("검찰_고발장", "검찰 고발장 (사건번호 2024심제1001). 공정거래위원회는 공정거래법 제71조에 따라 다음 피의자들을 고발함. 법인 4개사: (주)태평양건설, (주)한국종합건설, (주)대한건설산업, (주)서울엔지니어링. 개인 9명: 각 사 대표이사 4명 및 담합 실무 담당 임직원 5명. 혐의: 공정거래법 제40조 위반(부당한 공동행위), 형법 제315조 위반(경쟁입찰방해). 국민경제 질서를 심각하게 훼손한 중대범죄로 엄중한 처벌을 요청함."),
        ("언론공표_결정서", "언론공표 결정서 (사건번호 2024심제1001). 공정거래법 제50조의2에 따라 위반사실을 언론에 공표하기로 결정. 공표일 2024년 9월 25일. 공표 내용: 4개 건설사의 회사명, 대표이사 및 담당 임직원 성명, 위반행위의 구체적 내용, 과징금 액수. 보도자료를 주요 언론사에 배포하고 공정거래위원회 홈페이지에 게시. 공표를 통해 유사 행위 재발을 방지하고자 함."),
        ("이행강제금_부과예고통지서", f"이행강제금 부과예고 통지서 (사건번호 2024심제1001). 수신: {COMPANIES[0]} 대표이사 귀중. 귀사는 2024년 9월 20일자 시정명령을 받았으나, 2024년 11월 15일 현재 공정거래 자율준수 프로그램 도입 의무를 이행하지 않고 있음. 공정거래법 제50조에 따라 이행강제금 일일 500만원을 부과할 예정임. 본 통지서 수령 후 10일 이내 즉시 이행하지 않을 경우 강제금이 부과됨을 경고함."),
    ]

    for idx, (filename, summary) in enumerate(investigation_docs):
        filepath = create_json_file(filename, file_id, summary, days_offset=idx*10)
        generated_files.append(filepath)
        file_id += 1

    # 2. 기업별 답변서 및 의견서 (12 files)
    company_responses = []
    for company in COMPANIES:
        company_responses.extend([
            (f"{company}_서면답변서", f"{company} 서면답변서 (사건번호 2024심제1001, 제출일 2024년 3월). 당사는 공정거래위원회가 주장하는 담합 혐의를 전면 부인함. 당사는 모든 입찰에서 독자적 판단에 따라 입찰가를 산정하였으며, 타 업체와 어떠한 사전 협의도 하지 않았음. 공정위가 제시한 통화기록은 단순한 업계 정보 교류에 불과하며, 가격 담합과는 무관함. 입찰 낙찰률이 높은 것은 당사의 정확한 원가계산 능력 덕분이지 담합의 결과가 아님."),
            (f"{company}_의견서", f"{company} 의견서 (사건번호 2024심제1001, 제출일 2024년 6월). 공정거래위원회가 부과하고자 하는 과징금은 당사의 실제 위반 정도에 비해 과도함. 당사는 건설업계 불황으로 최근 3년간 적자를 기록하고 있으며, 과징금 부과 시 경영에 심각한 타격이 예상됨. 임직원 1,200명의 생계가 걸린 문제로 과징금을 최소 50% 이상 감경해 줄 것을 간곡히 요청함. 당사는 재발방지를 위해 최선을 다하겠음."),
            (f"{company}_소명자료", f"{company} 소명자료 (사건번호 2024심제1001, 제출일 2024년 8월). 당사의 입찰 프로세스가 독립적이고 자율적으로 운영되었음을 입증하는 자료 27건 제출. 주요 내용: (1) 사내 입찰가격 결정 프로세스 매뉴얼 - 원가계산팀, 영업팀, 경영진의 3단계 독립 검토 시스템. (2) 입찰가격 산정 회의록 15건 - 외부와의 접촉 없이 내부에서만 결정. (3) 공정거래 자율준수 가이드라인 - 2020년부터 시행 중. 당사는 정당한 경쟁을 해왔음."),
        ])

    for idx, (filename, summary) in enumerate(company_responses):
        filepath = create_json_file(filename, file_id, summary, days_offset=100+idx*3)
        generated_files.append(filepath)
        file_id += 1

    # 3. 담합 증거자료 - 통신기록 (15 files)
    communication_records = [
        (f"통화내역_{COMPANIES[0]}_to_{COMPANIES[1]}", f"통화내역 증거자료. 발신: {COMPANY_CONTACTS[COMPANIES[0]][0]} ({COMPANIES[0]} 영업담당), 수신: {COMPANY_CONTACTS[COMPANIES[1]][0]} ({COMPANIES[1]} 입찰담당). 통화일시 2023년 11월 5일 14:23, 통화시간 15분 32초. 서울시 지하철 9호선 연장공사 입찰을 앞두고 이루어진 통화. 두 담당자는 입찰 예정가격과 각 사의 입찰 의향에 대해 논의한 것으로 추정됨."),
        (f"통화내역_{COMPANIES[1]}_to_{COMPANIES[2]}", f"통화내역 증거자료. 발신: {COMPANY_CONTACTS[COMPANIES[1]][1]} ({COMPANIES[1]} 차장), 수신: {COMPANY_CONTACTS[COMPANIES[2]][0]} ({COMPANIES[2]} 본부장). 통화일시 2023년 11월 7일 09:45, 통화시간 8분 17초. 서울시 지하철 9호선 입찰 관련 후속 협의로 보임. 짧지만 핵심적인 내용을 주고받은 것으로 분석됨."),
        (f"통화내역_{COMPANIES[2]}_to_{COMPANIES[3]}", f"통화내역 증거자료. 발신: {COMPANY_CONTACTS[COMPANIES[2]][1]} ({COMPANIES[2]} 팀장), 수신: {COMPANY_CONTACTS[COMPANIES[3]][1]} ({COMPANIES[3]} 부장). 통화일시 2023년 11월 8일 16:30, 통화시간 22분 05초. 비교적 긴 통화로, 입찰 전략과 가격대에 대한 심도 있는 논의가 있었을 것으로 추정됨."),
        (f"문자메시지_{COMPANIES[0]}_담당자", f"문자메시지 기록. 발신: {COMPANY_CONTACTS[COMPANIES[0]][1]} ({COMPANIES[0]} 과장), 수신: 다수 (타 건설사 담당자 추정). 발신일시 2023년 12월 3일 오후 2:15. 내용: '내일 회동 장소 강남역 인근 카페, 오후 3시. 꼭 참석 부탁드립니다.' 인천공항 제2여객터미널 건설 입찰을 앞둔 시점의 비공식 회의 소집 정황."),
        (f"문자메시지_{COMPANIES[1]}_담당자", f"문자메시지 기록. 발신: {COMPANY_CONTACTS[COMPANIES[1]][0]} ({COMPANIES[1]} 이사), 수신: {COMPANY_CONTACTS[COMPANIES[2]][0]} ({COMPANIES[2]} 본부장). 발신일시 2023년 12월 4일 오전 10:30. 내용: '어제 논의한 가격 조율 건 확인 부탁드립니다. 우리 쪽 95.5%로 최종 조율했습니다.' 담합 정황을 직접적으로 보여주는 핵심 증거."),
        (f"카카오톡대화_{COMPANIES[0]}_{COMPANIES[1]}", f"{COMPANY_CONTACTS[COMPANIES[0]][0]}와 {COMPANY_CONTACTS[COMPANIES[1]][0]} 간 카카오톡 대화 내용 (2024년 1월 10일~15일, 총 47건 메시지). 주요 대화 내용: '이번 건 우리가 가져가는 걸로 하죠', '예정가 95% 선에서 맞추면 될 것 같습니다', '다음 물량은 귀사 차례니까요'. 입찰가격 사전 협의와 물량배분, 순번제 운영을 명확히 보여주는 결정적 증거."),
        (f"카카오톡대화_{COMPANIES[2]}_{COMPANIES[3]}", f"{COMPANY_CONTACTS[COMPANIES[2]][1]}과 {COMPANY_CONTACTS[COMPANIES[3]][1]} 간 카카오톡 대화 내용 (2024년 1월 20일~25일, 총 63건 메시지). 주요 대화: '낙찰예정가 확인했습니다. 1,150억 정도 될 것 같아요', '우리가 이번 턴 맞죠? 다른 쪽이랑도 협의 완료했습니다', '가격 더 내리면 안 됩니다. 합의 지켜야죠'. 체계적인 담합 구조를 입증."),
        (f"카카오톡_단체대화방", "카카오톡 단체 대화방 '협력회' 대화내용 (2023년 10월~2024년 2월, 총 234건 메시지). 참여자: 4개 건설사 담당자 8명. 주요 대화 내용: 입찰 일정 공유, '이번 건은 A사', '다음은 B사 순서', '가격은 예정가 95% 이상 유지', '절대 독자 행동 하지 말 것'. 4개사가 조직적으로 입찰을 배분하고 가격을 조율한 명백한 증거. 담합의 전모를 보여주는 결정적 자료."),
        (f"이메일_{COMPANIES[0]}_to_{COMPANIES[3]}", f"{COMPANY_CONTACTS[COMPANIES[0]][0]} ({COMPANIES[0]})가 {COMPANY_CONTACTS[COMPANIES[3]][0]} ({COMPANIES[3]})에게 발송한 이메일 (2024년 2월 5일). 제목: '견적 관련 협의'. 본문: '어제 회의에서 논의한 대로 첨부파일 견적서를 보내드립니다. 우리 쪽 95.3%, 귀사 95.7%로 조율하면 될 것 같습니다.' 첨부파일: 입찰가격표.xlsx. 입찰 전 가격 담합을 직접 보여주는 증거."),
        (f"이메일_{COMPANIES[1]}_내부문서", f"{COMPANIES[1]} 내부 이메일. 발신: {COMPANY_CONTACTS[COMPANIES[1]][0]} (영업담당 이사), 수신: 사장. 발신일 2024년 2월 10일. 제목: '부산항 신항 개발사업 입찰 전략 보고'. 본문 발췌: '타사와의 협의 결과 이번 건은 당사가 낙찰받기로 합의되었습니다. 예정가 95.5%로 입찰 예정이며, 타 3개사는 96% 이상으로 입찰하기로 하였습니다.' 회사 경영진이 담합을 인지하고 있었음을 보여줌."),
        (f"이메일_{COMPANIES[2]}_회람", f"{COMPANIES[2]} 내부 회람 이메일. 발신: 영업본부장, 수신: 영업팀 전체. 발신일 2024년 2월 15일. 제목: '입찰 주의사항 - 필독'. 본문: '각 담당자는 타사와 협의된 가격을 반드시 준수할 것. 독자적으로 가격을 내려 입찰하는 행위는 절대 금지함. 이를 위반할 경우 인사상 불이익이 있을 수 있음.' 회사 차원에서 조직적으로 담합을 관리했음을 입증."),
        (f"녹취록_비공식_회의_1차", f"제1차 비공식 회의 녹취록 (2023년 11월 12일, 서울 강남구 소재 한식당). 참석자: 4개 건설사 임원급 6명. 회의 시간 2시간 15분. 주요 내용: 서울시 지하철 9호선 연장공사 입찰 물량 배분 논의. '{COMPANIES[0]}이 이번 건을 가져가고, 다음 인천공항 건은 {COMPANIES[1]}이 하는 게 어떻겠나', '가격은 최소 95% 이상은 유지해야 한다', '너무 낮게 부르면 다 같이 망한다'. 담합 합의 과정이 녹음된 결정적 증거."),
        (f"녹취록_비공식_회의_2차", f"제2차 비공식 회의 녹취록 (2023년 12월 8일, 서울 여의도 소재 호텔 라운지). 참석자: 4개 건설사 실무자 8명. 회의 시간 1시간 45분. 주요 논의: 인천공항 제2여객터미널 건설 입찰가격 조율. '예정가가 1,200억 정도 될 것 같은데 95.8% 선에서 맞추자', '{COMPANIES[1]}이 낙찰받고 나머지는 96.5% 이상으로', '합의 깨는 순간 다 끝이니까 꼭 지키자'. 구체적인 가격 담합 과정."),
        (f"녹취록_비공식_회의_3차", f"제3차 비공식 회의 녹취록 (2024년 1월 18일, 경기도 성남시 소재 프라이빗 회의실). 참석자: 4개 건설사 담당자 전원 (12명). 회의 시간 3시간 20분. 주요 논의: 2024년 상반기 전체 입찰 일정 조율 및 순번 확정. 향후 6개월간 예정된 대형 공사 입찰 건을 4개사가 순번제로 나누어 가지기로 최종 합의. '1월 부산항은 C사, 2월 광역상수도는 D사, 3월 다시 A사 순서로'. 조직적이고 장기적인 담합 모의를 보여주는 핵심 증거."),
        (f"통신사_제출_상세통화내역", "통신사 제출 상세 통화내역 분석 보고서 (2023년 10월~2024년 3월). 분석 대상: 4개 건설사 주요 담당자 12개 전화번호. 총 통화 건수 287건. 분석 결과: 입찰 공고 직전 기간에 통화 빈도가 급증하는 패턴이 반복적으로 확인됨. 평상시 월 5~10건 수준이던 통화가 입찰 2주 전부터 월 40~60건으로 급증. 4개사 담당자들이 특정 시기에 집중적으로 연락을 주고받은 정황이 통계적으로 명확히 드러남."),
    ]

    for idx, (filename, summary) in enumerate(communication_records):
        filepath = create_json_file(filename, file_id, summary, days_offset=50+idx*5)
        generated_files.append(filepath)
        file_id += 1

    # 4. 입찰 관련 자료 (12 files)
    bidding_docs = []
    for idx, project in enumerate(BID_PROJECTS):
        bidding_docs.extend([
            (f"입찰공고문_{project}", f"{project} 입찰공고문. 발주기관: 서울특별시(1호), 인천국제공항공사(2호), 부산항만공사(3호), 한국수자원공사(4호) 중 해당 기관. 공고일 2023년 {10+idx}월. 추정금액 {(idx+1)*1200}억원. 입찰방법: 적격심사제 최저가낙찰제. 입찰마감일 공고일로부터 30일. 공사기간 24개월. 참가자격: 건설업 면허 보유 업체."),
            (f"낙찰자결정통지서_{project}", f"{project} 낙찰자 결정 통지서. 낙찰자: {COMPANIES[idx]}. 낙찰금액 {(idx+1)*1150}억원 (낙찰률 95.8%). 차순위: 타 건설사 (96.2%). 결정일 2023년 {11+idx}월. 계약체결 예정일 낙찰일로부터 10일 이내. {COMPANIES[idx]}의 입찰가격이 적격심사 기준을 통과하여 최저가로 낙찰됨."),
            (f"계약서_{project}", f"{project} 공사도급 계약서. 발주자: 해당 공공기관, 수급자: {COMPANIES[idx]}. 계약금액 {(idx+1)*1150}억원. 계약일 2024년 {1+idx}월. 공사기간 착공일로부터 24개월. 지체상금 일 0.15%. 대금지급 방법: 기성고에 따른 분할지급 (월 1회). 계약보증금 10%. 하자보수 보증기간 3년."),
        ])

    for idx, (filename, summary) in enumerate(bidding_docs):
        filepath = create_json_file(filename, file_id, summary, days_offset=30+idx*7)
        generated_files.append(filepath)
        file_id += 1

    # 5. 조사자료 및 증거자료 (11 files)
    investigation_evidence = [
        ("현장조사보고서_태평양건설", f"{COMPANIES[0]} 현장조사 보고서 (조사일 2024년 4월 8일). 조사관 5명 투입. 압수물품: 영업부 및 경영기획실 PC 4대, 사내 서버 1대, 입찰 관련 문서 125권, USB 메모리 3개. 주요 발견 사항: 타사와의 가격 협의 관련 내부 문서 다수 확보. 영업부장 컴퓨터에서 '입찰 배분 현황' 엑셀 파일 발견. 회사 차원의 조직적 담합 관여 정황 포착."),
        ("현장조사보고서_한국종합건설", f"{COMPANIES[1]} 현장조사 보고서 (조사일 2024년 4월 9일). 조사관 5명 투입. 압수물품: 임원 노트북 6대, 외장하드 2개, 계약 및 입찰 문서 98권. 주요 발견 사항: 삭제된 이메일 복구 성공 (타사 협의 관련 89건). 사장 메일함에서 '{COMPANIES[3]} 본부장과 합의 완료' 내용 확인. 고위 경영진의 담합 지시 정황 명확."),
        ("현장조사보고서_대한건설산업", f"{COMPANIES[2]} 현장조사 보고서 (조사일 2024년 4월 10일). 조사관 4명 투입. 압수물품: 영업본부 PC 3대, 회의록 및 계약서 67권, 회계장부 15권. 주요 발견 사항: 비공식 회의 관련 지출 내역 확인 (2023년 10월~2024년 2월, 총 12회 회식비 지출). 영업본부장 명의 '입찰 주의사항' 내부 회람 문서 발견."),
        ("현장조사보고서_서울엔지니어링", f"{COMPANIES[3]} 현장조사 보고서 (조사일 2024년 4월 11일). 조사관 4명 투입. 압수물품: 영업팀 PC 5대, 입찰 관련 문서 89권, 녹음 파일 3건. 주요 발견 사항: 담당 부장의 개인 녹음기에서 비공식 회의 녹취록 확보. 녹취 내용에 4개사 간 물량 배분 합의 과정이 명확히 담김. 결정적 물증 확보."),
        (f"진술조서_{COMPANY_CONTACTS[COMPANIES[0]][0]}", f"{COMPANY_CONTACTS[COMPANIES[0]][0]} ({COMPANIES[0]} 영업담당 부장) 진술조서 (2024년 5월 15일). 진술 요지: 비공식 회의 참석 사실은 인정하나 단순 친목 모임이었다고 주장. 추궁 결과 가격 협의가 있었음을 부분적으로 시인. 그러나 회사 경영진의 지시에 따른 것일 뿐 본인 의사가 아니었다고 주장. 책임 회피 태도 보임."),
        (f"진술조서_{COMPANY_CONTACTS[COMPANIES[1]][0]}", f"{COMPANY_CONTACTS[COMPANIES[1]][0]} ({COMPANIES[1]} 입찰담당 이사) 진술조서 (2024년 5월 17일). 진술 요지: 타사 담당자와 연락한 것은 인정하나 담합 의도는 전혀 없었다고 주장. 단순히 업계 정보를 교류하는 수준이었으며, 입찰가는 회사 내부에서 독자적으로 결정했다고 진술. 증거와 배치되는 진술로 신빙성 낮음."),
        ("입찰담합_합의_회의록", "입찰담합 합의 회의록 ({COMPANIES[0]} 내부문서, 2023년 11월 30일). 장소: 서울 강남구 소재 특급호텔 연회장. 참석자: 4개사 대표이사 및 영업담당 임원 총 8명. 안건: 향후 입찰 물량배분 원칙 합의. 합의 내용: (1) 순번제 도입 - 대형 공사는 4개사가 돌아가며 낙찰. (2) 최저가 방지 협약 - 입찰가는 예정가 95% 이상 유지. (3) 위반 시 제재 - 합의 위반 업체는 향후 물량배분에서 제외. 조직적 담합의 핵심 증거."),
        ("내부문서_입찰전략보고서", f"{COMPANIES[0]} 영업기획팀 작성 입찰전략 보고서 (2024년 1월 20일). 보고 대상: 대표이사 및 경영진. 내용: 타사와의 협의 결과 정리. 2024년 1분기 당사 할당 물량 2건 (서울시 지하철 9호선, 부산항 신항). 입찰 전략: 예정가격 95.5% 수준 입찰, 타사는 96% 이상 유지 약속. 낙찰 확률 95% 이상. 경영진이 담합을 인지하고 승인했음을 보여주는 증거."),
        ("증거목록_총괄", "증거목록 총괄 (사건번호 2024심제1001). 총 증거 456건. 분류: 통신기록 187건 (통화내역, 문자, 카카오톡), 문서 156건 (계약서, 회의록, 내부문서), 전자파일 98건 (이메일, 엑셀, 녹취), 기타 15건. 수집 기간 2024년 4월~6월. 보관 장소: 공정거래위원회 증거보관실. 모든 증거는 디지털 포렌식 절차를 거쳐 진정성립 확인됨."),
        ("감정의견서_디지털포렌식", "디지털 포렌식 감정의견서. 감정기관: 국립과학수사연구원 디지털증거분석과. 감정 기간 2024년 5월. 감정 대상: PC 22대, 서버 3대, 외장저장장치 8개. 감정 결과: 삭제된 카카오톡 대화 127건 복구 성공 (담합 관련 핵심 대화 포함), 삭제된 이메일 89건 복구 (가격 협의 내용). 증거의 진정성 및 무결성 확인. 법정 증거능력 인정 의견."),
        ("경제분석보고서", "경제분석 보고서 (공정거래위원회 경제분석국 작성). 분석 기간 2023~2024년. 분석 대상: 4개 건설사가 참여한 입찰 23건. 분석 결과: (1) 평균 낙찰률 95.7% (정상 입찰 시 85% 수준). (2) 낙찰가격 간 분산도 0.8% (정상 시 5% 이상). (3) 낙찰자가 4개사 간 규칙적으로 순환되는 패턴 확인. (4) 입찰 공고 직전 4개사 간 통신량 급증. 결론: 담합 개연성 매우 높음. 통계적으로 우연으로 설명 불가능."),
    ]

    for idx, (filename, summary) in enumerate(investigation_evidence):
        filepath = create_json_file(filename, file_id, summary, days_offset=120+idx*4)
        generated_files.append(filepath)
        file_id += 1

    return generated_files

if __name__ == "__main__":
    print("Generating 60 antitrust investigation JSON files...")
    print(f"Output directory: {OUTPUT_DIR}")
    print(f"Project ID: {PROJECT_ID}")
    print()

    generated = generate_all_files()

    print(f"\nSuccessfully generated {len(generated)} files:")
    print(f"Total files: {len(generated)}")
    print(f"Output directory: {OUTPUT_DIR}")
    print("\nFile categories:")
    print("- 심사보고서 및 처분서류: 10 files")
    print("- 기업별 답변서 및 의견서: 12 files")
    print("- 담합 증거자료(통신기록): 15 files")
    print("- 입찰 관련 자료: 12 files")
    print("- 조사자료 및 증거자료: 11 files")
    print(f"\nTotal: {len(generated)} files")
